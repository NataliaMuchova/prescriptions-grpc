syntax = "proto3";

package hospital;
option java_multiple_files = true;
option java_package = "via.pro3.prescriptionsgrpc.generated";
import "google/protobuf/timestamp.proto";

enum UserRoles {
  Invalid = 0;
  Patient = 1;
  Doctor = 2;
  Pharmacist = 3;
}

service Hospital {
  rpc GetPrescriptions (PrescriptionsRequest) returns (GetPrescriptionsReply);
  rpc CreatePrescription (CreatePrescriptionRequest) returns (PrescriptionReply);
  rpc CheckCredentials (CheckCredentialsRequest) returns (CheckCredentialsReply);
  rpc CreateUser (CreateUserRequest) returns (CreateUserReply);
}

message CreateUserRequest {
  string name = 1;
  string surname = 2;
  int64 cpr = 3;
  string password = 4;
  string phone = 5;
  string gender = 6;
  google.protobuf.Timestamp birthday = 7;
}

message CreateUserReply {
  string name = 1;
  string surname = 2;
  int64 cpr = 3;
  string password = 4;
  string phone = 5;
  string gender = 6;
  google.protobuf.Timestamp birthday = 7;
  UserRoles role = 8;
}

message CheckCredentialsRequest {
  int32 user_id = 1;
  string password = 2;
}

message CheckCredentialsReply {
  UserRoles role = 1;
}

message CreatePrescriptionRequest {
  int32 patient_id = 1;
  int32 doctor_id = 2;
  repeated Drug drugs = 3;
}

message PrescriptionsRequest {
  int32 patient_id = 1;
}

message GetPrescriptionsReply {
  repeated PrescriptionReply prescriptions = 1;
}

message Drug {
  int32 id = 1;
  string name = 2;
  string description = 3;
  int32 amount = 4;
  int32 availability_count = 5;
  string note = 6;
}

message PrescriptionReply {
  int32 id = 1;
  int32 patient_id = 2;
  int32 doctor_id = 3;
  google.protobuf.Timestamp issue_date = 4;
  google.protobuf.Timestamp expiration_date = 5;
  repeated Drug drugs = 6;
}